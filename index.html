<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>انضم لأسرة Momenta — HIET KFS</title>
  <meta name="description" content="نموذج تسجيل أعضاء جدد لأسرة Momenta بالمعهد العالي للهندسة والتكنولوجيا بكفر الشيخ" />
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&display=swap" rel="stylesheet" />
  <!-- AOS (on-scroll animations) -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
  <style>
    :root {
      --bg: #0b1020;
      --card: #111832;
      --muted: #99a6c4;
      --text: #e9eefc;
      --primary: #7aa7ff;
      --primary-2: #9d7cff;
      --accent: #49e1c8;
      --danger: #ff6b6b;
      --success: #34d399;
      --radius: 16px;
      --ring: 0 0 0 3px rgba(122,167,255,.25);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: 'Cairo', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, 'Noto Sans Arabic', sans-serif;
      background: radial-gradient(1200px 1200px at 80% -20%, rgba(157,124,255,.2), transparent 60%),
                  radial-gradient(800px 800px at 10% 10%, rgba(73,225,200,.18), transparent 50%),
                  var(--bg);
      color: var(--text);
      line-height: 1.7;
    }

    /* Header */
    header {
      position: sticky; top: 0; z-index: 50;
      background: rgba(11,16,32,.65);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .nav {
      max-width: 1100px; margin: 0 auto; padding: 14px 18px;
      display: flex; align-items: center; justify-content: space-between; gap: 12px;
    }
    .brand { display: flex; align-items: center; gap: 12px; }
    .brand img.logo { height: 40px; width: auto; filter: drop-shadow(0 6px 18px rgba(122,167,255,.25)); }
    .brand .title { font-weight: 800; letter-spacing: .3px; font-size: 18px; }

    .logo-strip { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; justify-content: flex-end; }
    .logo-strip img { height: 36px; width: auto; opacity: .9; transition: transform .2s ease; border-radius: 8px; background: rgba(255,255,255,.06); padding: 4px; }
    .logo-strip img:hover { transform: translateY(-2px) scale(1.02); }

    /* Hero */
    .hero {
      max-width: 1100px; margin: 0 auto; padding: 64px 18px 20px;
      display: grid; grid-template-columns: 1.1fr .9fr; gap: 28px; align-items: center;
    }
    @media (max-width: 900px) {
      .hero { grid-template-columns: 1fr; padding-top: 40px; }
    }
    .headline {
      font-size: clamp(26px, 3.4vw, 44px);
      font-weight: 800; line-height: 1.25;
      background: linear-gradient(90deg, var(--primary), var(--primary-2));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      margin: 0 0 12px;
    }
    .sub {
      color: var(--muted); font-weight: 500; margin-bottom: 22px; font-size: clamp(14px, 2.1vw, 18px);
    }

    .hero-card {
      position: relative; border-radius: calc(var(--radius) + 2px);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.08);
      padding: 14px; overflow: hidden;
    }
    .hero-card img { width: 100%; height: auto; display: block; }
    .glow {
      position: absolute; inset: -30%; z-index: -1; filter: blur(60px);
      background: radial-gradient(circle at 70% 30%, rgba(122,167,255,.25), transparent 50%),
                  radial-gradient(circle at 20% 80%, rgba(73,225,200,.25), transparent 50%);
      animation: floatGlow 14s linear infinite alternate;
    }
    @keyframes floatGlow { from { transform: translateY(-8px);} to { transform: translateY(8px);} }

    /* Section */
    .section { max-width: 1100px; margin: 0 auto; padding: 28px 18px 48px; }
    .section h2 { margin: 0 0 18px; font-size: 22px; }

    /* Feature cards */
    .grid { display: grid; gap: 14px; grid-template-columns: repeat(4, 1fr); }
    @media (max-width: 900px) { .grid { grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 560px) { .grid { grid-template-columns: 1fr; } }

    .card {
      background: var(--card); border: 1px solid rgba(255,255,255,.08);
      border-radius: var(--radius); padding: 18px; position: relative; overflow: hidden;
      transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .card:hover { transform: translateY(-4px); border-color: rgba(122,167,255,.35); box-shadow: 0 10px 30px rgba(0,0,0,.25); }
    .card .icon { width: 36px; height: 36px; display: grid; place-items: center; border-radius: 10px; background: rgba(122,167,255,.15); margin-bottom: 8px; }
    .card h3 { margin: 0 0 6px; font-size: 18px; }
    .card p { margin: 0; color: var(--muted); font-size: 14px; }

    /* Form */
    .form-wrap { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    @media (max-width: 900px) { .form-wrap { grid-template-columns: 1fr; } }

    form {
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.1);
      border-radius: var(--radius);
      padding: 18px; position: relative;
    }

    .field { margin-bottom: 14px; }
    label { display: block; margin-bottom: 6px; font-weight: 700; font-size: 14px; }

    input[type="text"], select, input[type="tel"] {
      width: 100%;
      background: #0e1530;
      border: 1px solid rgba(255,255,255,.16);
      color: var(--text);
      border-radius: 12px;
      padding: 12px 14px; outline: none; font-size: 15px;
      transition: border-color .2s ease, box-shadow .2s ease, transform .04s ease;
    }
    input:focus, select:focus { border-color: var(--primary); box-shadow: var(--ring); }
    input:invalid[aria-invalid="true"], select:invalid[aria-invalid="true"] { border-color: var(--danger); }

    .hint { color: var(--muted); font-size: 12px; margin-top: 6px; }
    .error { color: var(--danger); font-size: 12px; margin-top: 6px; display:none; }

    .actions { display: flex; align-items: center; gap: 10px; margin-top: 8px; flex-wrap: wrap; }
    button {
      appearance: none; cursor: pointer;
      background: linear-gradient(90deg, var(--primary), var(--primary-2));
      border: 0; color: #0b1020; font-weight: 800; letter-spacing: .3px;
      padding: 12px 18px; border-radius: 12px; box-shadow: 0 8px 30px rgba(122,167,255,.25);
      transition: transform .06s ease, filter .2s ease;
    }
    button:hover { filter: brightness(1.05); }
    button:active { transform: translateY(1px); }
    button[disabled] { opacity: .6; cursor: not-allowed; }

    .spinner { width: 18px; height: 18px; border: 3px solid rgba(255,255,255,.25); border-top-color: #0b1020; border-radius: 50%; display: inline-block; animation: spin .7s linear infinite; vertical-align: middle; }
    @keyframes spin { to { transform: rotate(360deg); } }

    .note { color: var(--muted); font-size: 13px; }

    /* Toast */
    .toast { position: fixed; inset-inline-start: 18px; bottom: 18px; z-index: 60; display: none; }
    .toast .inner { background: #0f1a38; border: 1px solid rgba(255,255,255,.12); border-inline-start: 6px solid var(--success);
      color: var(--text); border-radius: 12px; padding: 12px 14px; min-width: 240px; box-shadow: 0 8px 30px rgba(0,0,0,.28); }
    .toast.error .inner { border-inline-start-color: var(--danger); }

    footer { text-align: center; color: var(--muted); padding: 36px 18px 54px; font-size: 13px; }

    /* small util */
    .badge { display:inline-block; background: rgba(73,225,200,.14); color:#aef5eb; padding:6px 10px; border-radius:999px; font-size:12px; font-weight:700; margin-bottom:10px; }

    /* === Creative Media Team extras === */
    .taglist { display:flex; flex-wrap:wrap; gap:8px; margin-top:10px }
    .tag { background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12); padding:6px 10px; border-radius:999px; font-size:12px }
    .cta {
      display:inline-flex; align-items:center; gap:8px; margin-top:12px;
      background: linear-gradient(90deg, var(--accent), var(--primary));
      color:#0b1020; font-weight:900; padding:12px 16px; border-radius:12px; border:0; cursor:pointer
    }
    .cta:hover { filter:brightness(1.05) }
    .role-grid { display:grid; gap:14px; grid-template-columns: repeat(4, 1fr); }
    @media (max-width: 900px) { .role-grid { grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 560px) { .role-grid { grid-template-columns: 1fr; } }
    .role-card {
      background: var(--card); border: 1px solid rgba(255,255,255,.08);
      border-radius: var(--radius); padding: 18px; transition: transform .2s ease, border-color .2s ease;
    }
    .role-card:hover { transform: translateY(-3px); border-color: rgba(73,225,200,.35); }
  </style>
</head>
<body>
  <header>
    <div class="nav">
      <div class="brand">
        <img id="momentaLogo" class="logo" src="assets/1.png" alt="شعار Momenta" />
        <div class="title">أسرة <span style="color:#a1b8ff">Momenta</span> — HIET KFS</div>
      </div>
      <div class="logo-strip">
        <img id="hietLogo" src="assets/2.png" alt="شعار المعهد العالي للهندسة والتكنولوجيا بكفر الشيخ" title="HIET KFS" />
        <img id="youthLogo" src="assets/4.png" alt="شعار رعاية الشباب" title="رعاية الشباب" />
        <img id="moheLogo" src="assets/3.png" alt="شعار وزارة التعليم العالي والبحث العلمي" title="وزارة التعليم العالي" />
      </div>
    </div>
  </header>

  <main>
    <!-- Creative Media Team Section -->
    <section class="section" id="creative">
      <span class="badge" data-aos="zoom-in">فرصة تطوّع</span>
      <h1 class="headline" data-aos="fade-up" data-aos-delay="60">انضم لفريق الـ<br>Creative Media Team</h1>
      <br>
      <button class="cta" id="ctaCreative" data-aos="fade-up" data-aos-delay="140">📝 قدّم لفريق Creative Media Team</button>
      <br>
      <br>
      <p class="sub" data-aos="fade-up" data-aos-delay="60">
        لو عندك موهبة في التصميم أو المونتاج أو السوشيال ميديا، وعايز توري شغلك للكل… مكانك معانا!
        أسرة <strong>Momenta</strong> بتكوّن فريق <strong>Creative Media Team</strong> المسؤول عن:
      </p>

      <div class="role-grid" data-aos="fade-up" data-aos-delay="100">
        <div class="role-card">
          <div class="icon">🎨</div>
          <h3>تصميم الجرافيك</h3>
          <p>تصميم بوسترات رسمية، هويات فرعية، قوالب سوشيال.</p>
          <div class="taglist"><span class="tag">Photoshop</span><span class="tag">Illustrator</span><span class="tag">Figma</span></div>
        </div>
        <div class="role-card">
          <div class="icon">🎥</div>
          <h3>فيديو ومونتاج</h3>
          <p>فيديوهات دعائية، ريلز، موشن بسيط.</p>
          <div class="taglist"><span class="tag">Premiere</span><span class="tag">CapCut</span><span class="tag">After Effects</span></div>
        </div>
        <div class="role-card">
          <div class="icon">📸</div>
          <h3>تصوير وتغطية</h3>
          <p>توثيق فعاليات الأسرة صورًا وفيديو.</p>
          <div class="taglist"><span class="tag">Photography</span><span class="tag">Lighting</span><span class="tag">Color</span></div>
        </div>
        <div class="role-card">
          <div class="icon">🌐</div>
          <h3>إدارة السوشيال</h3>
          <p>كتابة المحتوى، الجداول، الـ Insights.</p>
          <div class="taglist"><span class="tag">Content</span><span class="tag">Scheduling</span><span class="tag">Analytics</span></div>
        </div>
      </div>
      <br>
      <br>
    </section>

    <!-- Form Section -->
    <section class="section">
      <h2 data-aos="fade-up">سجّل بياناتك</h2>
      <div class="form-wrap">
        <form id="signupForm" novalidate data-aos="fade-up" data-aos-delay="60">
          <div class="field">
            <label for="fullName">الاسم الثلاثي بالعربية <span style="color:#8fb3ff">*</span></label>
            <input id="fullName" name="fullName" type="text" placeholder="مثال: أحمد محمد علي" required inputmode="text" autocomplete="name" aria-invalid="false" minlength="7" />
            <div class="hint">يجب أن يتكوّن من 3 كلمات عربية على الأقل.</div>
            <div class="error" id="nameError">فضلاً اكتب اسمك ثلاثي بالعربية.</div>
          </div>

          <div class="field">
            <label for="level">الفرقة الدراسية <span style="color:#8fb3ff">*</span></label>
            <select id="level" name="level" required aria-invalid="false">
              <option value="" selected disabled>اختر الفرقة</option>
              <option value="Preparatory">الفرقة الإعدادية</option>
              <option value="First">الأولى</option>
              <option value="Second">الثانية</option>
              <option value="Third">الثالثة</option>
              <option value="Fourth">الرابعة</option>
            </select>
            <div class="error" id="levelError">فضلاً اختر الفرقة الدراسية.</div>
          </div>

          <div class="field">
            <label for="nationalId">الرقم القومي (14 رقم) <span style="color:#8fb3ff">*</span></label>
            <input id="nationalId" name="nationalId" type="text" inputmode="numeric" pattern="^\d{14}$" maxlength="14" minlength="14" required aria-invalid="false" placeholder="مثال: 29811151234567" />
            <div class="hint">تأكد من كتابة 14 رقماً بدون فواصل.</div>
            <div class="error" id="nidError">الرقم القومي يجب أن يكون 14 رقماً.</div>
          </div>

          <div class="field">
            <label for="phone">رقم الموبايل (11 رقم) <span style="color:#8fb3ff">*</span></label>
            <input id="phone" name="phone" type="tel" inputmode="tel" pattern="^01[0-2,5]\\d{8}$" maxlength="11" minlength="11" required aria-invalid="false" placeholder="مثال: 01012345678" />
            <div class="hint">يبدأ بـ 010 أو 011 أو 012 أو 015 ويتكون من 11 رقماً.</div>
            <div class="error" id="phoneError">رقم الموبايل غير صحيح.</div>
          </div>

          <!-- اختيار الفريق + أخرى -->
          <div class="field">
            <label for="interest">الفريق الذي ترغب بالانضمام إليه (اختياري)</label>
            <select id="interest" name="interest" aria-invalid="false">
              <option value="" disabled selected>— اختر الفريق —</option>
              <option value="Graphic Design">Creative Media — Graphic Design</option>
              <option value="Video Editing">Creative Media — Video Editing</option>
              <option value="Photography">Creative Media — Photography</option>
              <option value="Social Media">Creative Media — Social Media</option>
              <option value="Motion Graphics">Creative Media — Motion Graphics</option>
              <option value="Content Writing">Creative Media — Content Writing</option>
              <option value="other">أخرى</option>
            </select>
            <div class="error" id="interestError">فضلاً اختر فريق محدد.</div>
            <div class="hint">اختيارك يساعدنا نوصل فريق الكرياتيف بيك أسرع.</div>

            <!-- يظهر فقط لو اختار "أخرى" -->
            <div id="otherInterestWrap" class="field" style="display:none; margin-top:10px">
              <label for="otherInterest">اذكر مهارتك أو الدور في مجال الميديا</label>
              <input id="otherInterest" name="otherInterest" type="text" inputmode="text" placeholder="مثال: Podcast Editing / UI Motion / 3D / Voice Over" />
              <div class="hint">اكتب مهارة محددة علشان نعرف نسبّتك للفريق المناسب.</div>
              <div class="error" id="otherError">من فضلك اكتب مهارتك في خانة "أخرى".</div>
            </div>
          </div>

          <div class="field">
            <label for="portfolio">روابط أعمالك/بورتفوليو (اختياري)</label>
            <input id="portfolio" name="portfolio" type="text" inputmode="url" placeholder="مثال: behance.net/username أو رابط Google Drive" />
            <div class="hint">لو ماعندكش بورتفوليو حالياً ممكن تسيبها فاضية.</div>
          </div>

          <div class="actions">
            <button id="submitBtn" type="submit">
              <span class="btnText">إرسال الطلب</span>
            </button>
            <span class="note">بالضغط على "إرسال" فأنت توافق على استخدام بياناتك لأغراض نشاط الأسرة داخل المعهد.</span>
          </div>
        </form>

        <div class="card" data-aos="fade-up" data-aos-delay="120">
          <h3 style="margin-top:0">لماذا ننصحك بالتسجيل الآن؟</h3>
          <p>حتى تصلك أولاً بأول الدعوات لورش العمل والندوات والمسابقات، وتقدر تشارك في الفرق والمشروعات الطلابية وتبني بورتفوليو قوي.</p>
          <ul style="margin:10px 0 0 18px; color:var(--muted);">
            <li>أولوية الحضور للأعضاء المسجلين.</li>
            <li>شهادات مشاركة لمناسبات مختارة.</li>
            <li>مجتمع يساندك ويحفّزك.</li>
            <li><strong>تكون من الأوائل</strong> في تلقي الدعوات لورش العمل والندوات والرحلات العلمية.</li>
            <li><strong>فرص المشاركة في مشاريع عملية</strong> تبني لك خبرة وبورتفوليو قوي.</li>
            <li><strong>أولوية الحضور</strong> للأعضاء المسجلين في جميع الفعاليات المهمة.</li>
            <li><strong>شهادات مشاركة وتقدير</strong> تدعم سيرتك الذاتية.</li>
            <li><strong>التواصل المباشر مع الدكاترة والخريجين</strong> وأصحاب الخبرة في المجال.</li>
            <li><strong>مجتمع محفّز</strong> يشاركك نفس الشغف ويشجعك على التطوير.</li>
            <li><strong>فرص الانضمام لفرق متخصصة</strong> زي البرمجة، الروبوتات، أو الكرياتيف ميديا.</li>
            <li><strong>إعلانات خاصة عن منح وتدريبات</strong> مش هتوصلك إلا لو كنت عضو.</li>
            <li><strong>دعم لمبادراتك وأفكارك</strong> علشان تنفذ مشاريعك داخل الأسرة.</li>
            <li><strong>فرص قيادة وتنظيم فعاليات</strong> تكسبك مهارات في الإدارة والعمل الجماعي.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Hero -->
    <section class="hero">
      <div>
        <p class="sub" data-aos="fade-up" data-aos-delay="120">هدفنا تمكين طلاب المعهد بالمهارات العملية في البرمجة والروبوتات والذكاء الاصطناعي وريادة الأعمال — من خلال ورش عمل، مشاريع طلابية، وفعاليات قوية على مدار العام.</p>
        <div class="grid" style="margin-top:14px;" data-aos="fade-up" data-aos-delay="160">
          <div class="card">
            <div class="icon">💡</div>
            <h3>ورش عملية</h3>
            <p>جلسات تطبيقية منتظمة في البرمجة، الإلكترونيات، والـ AI.</p>
          </div>
          <div class="card">
            <div class="icon">🤝</div>
            <h3>مجتمع داعم</h3>
            <p>شبكة زملاء وموجّهين لمتابعة تقدّمك.</p>
          </div>
          <div class="card">
            <div class="icon">🚀</div>
            <h3>مسابقات ومشروعات</h3>
            <p>بناء بورتفوليو قوي ومشاركة في منافسات.</p>
          </div>
          <div class="card">
            <div class="icon">📣</div>
            <h3>فرص وفعاليات</h3>
            <p>إعلانات عن برامج تدريب، ندوات، وشراكات.</p>
          </div>
        </div>
      </div>
      <div class="hero-card" data-aos="fade-left">
        <div class="glow" aria-hidden="true"></div>
        <!-- ضع صورة الروبوت/البانر هنا -->
        <img id="robotImage" src="assets/5.png" alt="Momenta Robot" />
      </div>
    </section>

  </main>

  <div id="toast" class="toast" role="status" aria-live="polite">
    <div class="inner" id="toastInner">تم الإرسال بنجاح ✅</div>
  </div>

  <footer>
    © <span id="year"></span> أسرة Momenta — المعهد العالي للهندسة والتكنولوجيا بكفر الشيخ. جميع الحقوق محفوظة.
  </footer>

  <!-- AOS -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init({ once: true, duration: 640, easing: 'ease-out-cubic' });
  </script>

  <script>
    // === 1) إعداد رابط تطبيق Google Apps Script (استبدل القيمة عند الحاجة) ===
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzQsHreGQ2frjG14SP4QcPcq3gyqyvNx7w-XLexMEE1xDIJupQugUL8jaJrC25H5uA/exec';

    // === 2) عناصر مساعدة ===
    const form = document.getElementById('signupForm');
    const submitBtn = document.getElementById('submitBtn');
    const btnText = submitBtn.querySelector('.btnText');
    const toast = document.getElementById('toast');
    const toastInner = document.getElementById('toastInner');
    const ctaCreative = document.getElementById('ctaCreative');

    // سنة الفوتر
    document.getElementById('year').textContent = new Date().getFullYear();

    // دالة قراءة باراميتر من الرابط
    function getParam(key) {
      const u = new URL(location.href);
      return u.searchParams.get(key);
    }

    // تحقق مخصص للاسم العربي ثلاثي
    function isArabicThreeWords(value) {
      const cleaned = (value || '').trim().replace(/\s+/g, ' ');
      const parts = cleaned.split(' ');
      if (parts.length < 3) return false;
      const ar = /^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF]+$/;
      return parts.slice(0,3).every(p => ar.test(p));
    }

    function showError(id, show = true) {
      const el = document.getElementById(id);
      if (el) el.style.display = show ? 'block' : 'none';
    }

    function setInvalid(field, invalid) {
      field.setAttribute('aria-invalid', invalid ? 'true' : 'false');
    }

    function showToast(message, isError = false) {
      toast.classList.toggle('error', !!isError);
      toastInner.textContent = message;
      toast.style.display = 'block';
      setTimeout(() => { toast.style.display = 'none'; }, 3800);
    }

    async function submitData(payload) {
      const body = new URLSearchParams(payload);
      try {
        const res = await fetch(SCRIPT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
          body,
        });
    
        if (res.type === 'opaque') {
          return { ok: true, note: 'opaque-response' };
        }
    
        if (res.ok) {
          const ct = res.headers.get('Content-Type') || '';
          if (ct.includes('application/json')) {
            const data = await res.json().catch(() => ({ ok: true, note: 'json-parse-fallback' }));
            if (typeof data.ok === 'string') data.ok = data.ok === 'true';
            return data.ok ? data : { ok: true, note: 'ok-true-by-2xx' };
          } else {
            return { ok: true, note: 'non-json-2xx' };
          }
        }
    
        let errDetail = '';
        try {
          const t = await res.text();
          errDetail = t?.slice(0, 200);
        } catch (_) {}
        return { ok: false, error: `http-${res.status} ${res.statusText} ${errDetail}`.trim() };
    
      } catch (err) {
        return { ok: false, error: `network-error: ${err.message}` };
      }
    }


    // إظهار/إخفاء خانة "أخرى" حسب الاختيار
    const interestSel = document.getElementById('interest');
    const otherWrap = document.getElementById('otherInterestWrap');
    const otherInput = document.getElementById('otherInterest');

    function toggleOther() {
      if (!interestSel) return;
      const isOther = interestSel.value === 'other';
      otherWrap.style.display = isOther ? 'block' : 'none';
      if (isOther) {
        otherInput.setAttribute('required', 'required');
        otherInput.focus();
      } else {
        otherInput.removeAttribute('required');
        showError('otherError', false);
      }
    }
    interestSel?.addEventListener('change', toggleOther);

    // CTA: تعبئة اختيار الكرياتيف والتمرير للفورم
    if (ctaCreative) {
      ctaCreative.addEventListener('click', () => {
        if (interestSel) interestSel.value = 'Creative Media Team';
        toggleOther();
        document.getElementById('fullName')?.focus();
        form?.scrollIntoView({ behavior: 'smooth', block: 'start' });
      });
    }

    // تمييز اختيار الكرياتيف من اللينك ?team=creative
    const teamParam = (getParam('team') || '').toLowerCase();
    if (teamParam === 'creative' || teamParam === 'creative-media' || teamParam === 'creative-media-team') {
      if (interestSel) interestSel.value = 'Creative Media Team';
      toggleOther();
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const fullName = document.getElementById('fullName');
      const level = document.getElementById('level');
      const nationalId = document.getElementById('nationalId');
      const phone = document.getElementById('phone');

      // إعادة ضبط الأخطاء
      showError('nameError', false);
      showError('levelError', false);
      showError('nidError', false);
      showError('phoneError', false);
      showError('otherError', false);

      setInvalid(fullName, false);
      setInvalid(level, false);
      setInvalid(nationalId, false);
      setInvalid(phone, false);

      // تحقق يدوي
      let valid = true;
      if (!isArabicThreeWords(fullName.value)) { showError('nameError', true); setInvalid(fullName, true); valid = false; }
      if (!level.value) { showError('levelError', true); setInvalid(level, true); valid = false; }
      if (!/^\d{14}$/.test(nationalId.value)) { showError('nidError', true); setInvalid(nationalId, true); valid = false; }
      if (!/^01[0-2,5]\d{8}$/.test(phone.value)) { showError('phoneError', true); setInvalid(phone, true); valid = false; }

      // التحقق من اختيار الفريق
      if (!interestSel.value || interestSel.value === '') {
        showError('interestError', true);
        interestSel.setAttribute('aria-invalid', 'true'); // يخلي البوردر أحمر
        valid = false;
      } else {
        showError('interestError', false);
        interestSel.setAttribute('aria-invalid', 'false');
      }

      // تحقق من خانة "أخرى"
      const isOther = interestSel && interestSel.value === 'other';
      if (isOther && !otherInput.value.trim()) {
        showError('otherError', true);
        valid = false;
      }

      if (!valid) { showToast('تأكد من صحة الحقول المظللة باللون الأحمر', true); return; }

      // تعطيل الزر أثناء الإرسال
      submitBtn.disabled = true;
      btnText.innerHTML = '<span class="spinner"></span> جارٍ الإرسال...';

      const payload = {
        fullName: fullName.value.trim(),
        level: level.value,
        nationalId: nationalId.value.trim(),
        phone: phone.value.trim(),
        interest: (interestSel?.value || '').trim(),
        otherInterest: (otherInput?.value || '').trim(),
        portfolio: (document.getElementById('portfolio')?.value || '').trim(),
        ua: navigator.userAgent,
        ref: document.referrer || location.href,
      };

      const result = await submitData(payload);

      console.log('Submit result:', result); // مفيد للتشخيص
      
      if (result && result.ok) {
        form.reset();
        toggleOther();
        showToast('تم استلام طلبك بنجاح! سنوافيك بالتفاصيل قريبًا ✅');
      } else {
        const msg = (result && result.error)
          ? `تعذّر الإرسال: ${result.error}`
          : 'تعذّر الإرسال حالياً. حاول مرة أخرى لاحقًا.';
        showToast(msg, true);
      }
      
      submitBtn.disabled = false;
      btnText.textContent = 'إرسال الطلب';
    });
  </script>
</body>
</html>
